Inspired from: https://interrupt.memfault.com/blog/firmware-shell